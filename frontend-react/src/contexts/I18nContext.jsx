import React, { createContext, useContext, useState, useEffect, useMemo } from 'react';

const translations = {
  tr: {
    home: 'Ana Sayfa',
    learn: 'Ã–ÄŸren',
    assignments: 'Ã–devler',
    badges: 'Rozetler',
    dashboard: 'Panelim',
    classes: 'SÄ±nÄ±flar',
    exams: 'SÄ±navlar',
    settings: 'Ayarlar',
    profile: 'Profil',
    preview: 'Ã–nizle',
    save: 'Kaydet',
    cancel: 'Ä°ptal',
    create_exam: 'Yeni SÄ±nav OluÅŸtur',
    edit_exam: 'SÄ±navÄ± DÃ¼zenle',
    select_classes: 'SÄ±nÄ±flarÄ± SeÃ§',
    login: 'GiriÅŸ Yap',
    register: 'KayÄ±t Ol',
    logout: 'Ã‡Ä±kÄ±ÅŸ',
    theme_light: 'AydÄ±nlÄ±k',
    theme_dark: 'KaranlÄ±k',
    language: 'Dil',
    home_hero_title: 'Matematik MacerasÄ±',
    home_hero_sub: 'Ã–rÃ¼ntÃ¼lerle EÄŸlenceli Ã–ÄŸrenme DÃ¼nyasÄ±',
    home_hero_desc: 'SayÄ±lar, ÅŸekiller ve renklerle dolu harika bir yolculuÄŸa hazÄ±r mÄ±sÄ±n? Hadi birlikte Ã¶rÃ¼ntÃ¼leri keÅŸfedelim! ðŸš€',
    stats_section: 'Ä°statistikler',
    stat_questions: 'EÄŸlenceli Soru',
    stat_students: 'Mutlu Ã–ÄŸrenci',
    stat_xp: 'KazanÄ±lan XP',
    stat_fun: 'EÄŸlence Garantisi',
    exam_basic_info: 'Temel Bilgiler',
    exam_title_label: 'SÄ±nav BaÅŸlÄ±ÄŸÄ±',
    exam_title_ph: 'Ã–rn: 10. SÄ±nÄ±f Matematik DÃ¶nem Sonu SÄ±navÄ±',
    exam_class_level: 'SÄ±nÄ±f Seviyesi',
    exam_class_level_select: 'SÄ±nÄ±f Seviyesi SeÃ§in',
    exam_category: 'Kategori',
    exam_category_select: 'Kategori SeÃ§in',
    exam_difficulty: 'Zorluk Seviyesi',
    difficulty_easy: 'Kolay',
    difficulty_medium: 'Orta',
    difficulty_hard: 'Zor',
    exam_description: 'AÃ§Ä±klama',
    exam_description_ph: 'SÄ±nav hakkÄ±nda kÄ±sa bir aÃ§Ä±klama yazÄ±n...',
    exam_duration_min: 'SÃ¼re (Dakika)',
    exam_pass_mark: 'GeÃ§me Notu (%)',
    exam_total_points: 'Toplam Puan',
    exam_timing: 'Zamanlama',
    exam_start_date: 'BaÅŸlangÄ±Ã§ Tarihi',
    exam_end_date: 'BitiÅŸ Tarihi',
    exam_assignment: 'SÄ±nav Atama',
    exam_assignment_hint: 'Bu sÄ±navÄ±n hangi sÄ±nÄ±flara atanacaÄŸÄ±nÄ± seÃ§in (opsiyonel)',
    exam_settings: 'SÄ±nav AyarlarÄ±',
    exam_publish: 'SÄ±navÄ± YayÄ±nla',
    exam_allow_review: 'Ä°ncelemeye Ä°zin Ver',
    exam_shuffle_questions: 'SorularÄ± KarÄ±ÅŸtÄ±r',
    exam_show_results: 'SonuÃ§larÄ± GÃ¶ster',
    exam_allow_retake: 'Tekrar GiriÅŸe Ä°zin Ver',
    exam_max_attempts: 'Maksimum Deneme SayÄ±sÄ±',
    exam_question_selection: 'Soru SeÃ§imi',
    questions_selected: 'soru seÃ§ildi',
    all_classes: 'TÃ¼m SÄ±nÄ±flar',
    all_subjects: 'TÃ¼m Dersler',
    all_difficulties: 'TÃ¼m Zorluklar',
    no_questions_for_level: 'iÃ§in soru bulunamadÄ±. LÃ¼tfen soru havuzuna soru ekleyin.',
    select_class_level_first: 'LÃ¼tfen Ã¶nce sÄ±nÄ±f seviyesi seÃ§in.',
    preview: 'Ã–nizle',
    save_exam: 'SÄ±navÄ± Kaydet',
    no_classes_yet: 'HenÃ¼z oluÅŸturulmuÅŸ sÄ±nÄ±f bulunmuyor. Ã–nce sÄ±nÄ±f oluÅŸturmalÄ±sÄ±nÄ±z.',
    class_suffix: 'SÄ±nÄ±f',
    student_suffix: 'Ã¶ÄŸrenci',
    classes_selected: 'sÄ±nÄ±f seÃ§ildi',
    status: 'Durum',
    status_draft: 'Taslak',
    status_active: 'Aktif',
    status_ended: 'Sona Erdi',
    exam_loading: 'SÄ±nav yÃ¼kleniyor...',
    error: 'Hata',
    back_to_exams: 'SÄ±navlara DÃ¶n',
    questions: 'Sorular',
    questions_added: 'soru eklendi',
    saving: 'ðŸ’¾ Kaydediliyor...',
    save_changes: 'ðŸ’¾ DeÄŸiÅŸiklikleri Kaydet'
  },
  en: {
    home: 'Home',
    learn: 'Learn',
    assignments: 'Assignments',
    badges: 'Badges',
    dashboard: 'Dashboard',
    classes: 'Classes',
    exams: 'Exams',
    settings: 'Settings',
    profile: 'Profile',
    preview: 'Preview',
    save: 'Save',
    cancel: 'Cancel',
    create_exam: 'Create New Exam',
    edit_exam: 'Edit Exam',
    select_classes: 'Select Classes',
    login: 'Login',
    register: 'Register',
    logout: 'Logout',
    theme_light: 'Light',
    theme_dark: 'Dark',
    language: 'Language',
    home_hero_title: 'Math Adventure',
    home_hero_sub: 'A Fun World of Learning with Patterns',
    home_hero_desc: 'Are you ready for a journey full of numbers, shapes and colors? Letâ€™s discover patterns together! ðŸš€',
    stats_section: 'Statistics',
    stat_questions: 'Fun Questions',
    stat_students: 'Happy Students',
    stat_xp: 'XP Earned',
    stat_fun: 'Fun Guaranteed',
    exam_basic_info: 'Basic Information',
    exam_title_label: 'Exam Title',
    exam_title_ph: 'e.g., 10th Grade Math Final Exam',
    exam_class_level: 'Class Level',
    exam_class_level_select: 'Select Class Level',
    exam_category: 'Category',
    exam_category_select: 'Select Category',
    exam_difficulty: 'Difficulty',
    difficulty_easy: 'Easy',
    difficulty_medium: 'Medium',
    difficulty_hard: 'Hard',
    exam_description: 'Description',
    exam_description_ph: 'Write a short description about the exam...',
    exam_duration_min: 'Duration (Minutes)',
    exam_pass_mark: 'Pass Mark (%)',
    exam_total_points: 'Total Points',
    exam_timing: 'Timing',
    exam_start_date: 'Start Date',
    exam_end_date: 'End Date',
    exam_assignment: 'Assign Exam',
    exam_assignment_hint: 'Select which classes this exam will be assigned to (optional)',
    exam_settings: 'Exam Settings',
    exam_publish: 'Publish Exam',
    exam_allow_review: 'Allow Review',
    exam_shuffle_questions: 'Shuffle Questions',
    exam_show_results: 'Show Results',
    exam_allow_retake: 'Allow Retake',
    exam_max_attempts: 'Maximum Attempts',
    exam_question_selection: 'Question Selection',
    questions_selected: 'questions selected',
    all_classes: 'All Classes',
    all_subjects: 'All Subjects',
    all_difficulties: 'All Difficulties',
    no_questions_for_level: 'has no questions. Please add to the question bank.',
    select_class_level_first: 'Please select class level first.',
    preview: 'Preview',
    save_exam: 'Save Exam',
    no_classes_yet: 'No classes created yet. Please create a class first.',
    class_suffix: 'Class',
    student_suffix: 'students',
    classes_selected: 'classes selected',
    status: 'Status',
    status_draft: 'Draft',
    status_active: 'Active',
    status_ended: 'Ended',
    exam_loading: 'Loading exam...',
    error: 'Error',
    back_to_exams: 'Back to Exams',
    questions: 'Questions',
    questions_added: 'questions added',
    saving: 'ðŸ’¾ Saving...',
    save_changes: 'ðŸ’¾ Save Changes'
  }
};

const I18nContext = createContext();

export function I18nProvider({ children }) {
  const [lang, setLang] = useState(() => localStorage.getItem('lang') || 'tr');

  useEffect(() => {
    localStorage.setItem('lang', lang);
  }, [lang]);

  const t = (key) => translations[lang][key] || key;

  const value = useMemo(() => ({
    lang,
    setLang,
    t,
    toggleLang: () => setLang((prev) => (prev === 'tr' ? 'en' : 'tr'))
  }), [lang]);

  return <I18nContext.Provider value={value}>{children}</I18nContext.Provider>;
}

export function useI18n() {
  return useContext(I18nContext);
}
